# Chapter 9. 디스크 관리

- 디스크 스케줄링 기법
- 저전력 디스크 관리 기법
- 엘리베이터 스케줄링 문제



## 1. 디스크의 구조

![image-20210703174019972](chapter9.assets/image-20210703174019972.png)

섹터 -> 트랙 -> 실린더





## 2. 디스크 스케줄링

> 디스크의 입출력 효율을 높이기 위해서는 접근시간을 최소화 해야한다.

- 접근시간
  - 탐색시간
    - 디스크 헤드를 해당 실린더로 이동시키는 데 걸리는 시간
  - 회전지연시간
    - 디스크가 회전해서 읽고 쓰려는 섹터가 헤드 위치에 도달한 후 데이터를 실제로 섹터에 읽고 쓰는데 소요되는 시간
  - 전송시간



- 디스크 스케줄링

  - 효율적인 디스크 입출력을 위해 여러 섹터들에 대한 입출력 요청 시 처리순서를 결정하는 매커니즘

  - 접근 시간 중 회전지연시간과 전송시간은 상대적인 수치가 작으며, 운영체제에서 통제하기 힘든 부분이기 때문에 운영체제에서는 탐색시간에 대한 스케줄링을 작업, 즉 헤드의 움직임을 최소화하는 스케줄링 작업을 한다.



### 1. FCFS 스케줄링

- 선입선출 스케줄링



### 2. SSTF(Shortest Seek Time First) 스케줄링

- 헤드의 현재 위치로부터 가장 가까운 위치에 있는 요청을 제일 먼저 처리하는 알고리즘
- 기아 현상 발생
- *CPU 스케줄링에서 최단작업 우선 스케줄링과 대응된다.*



### 3. SCAN 알고리즘

- 헤드에 대한 요청 위치와 관계 없이 헤드가 정해진 방향으로 이동하면서 요청을 처리하는 것
- 엘리베이터 스케줄링 알고리즘이라고도 함
- FCFS에서의 불필요한 헤드의 이동이 발생하지 않고, SSTF처럼 기아현상이 발생하지 않는다.
- *CPU스케줄링에서 라운드 로빈 스케줄링과 대응된다.*
- 하지만, 실린더의 양쪽 끝보다 가운데의 기다리는 시간이 훨씬 짧다는 문제점이 있다.



### 4. C-SCAN 알고리즘

- SCAN과 달리 헤더가 다른 쪽 끝에 도달해 방향을 바꾼 후에는 요청을 처리하지 않고 출발점으로 이동만 한다.
- 이를 통해 SCAN보다 헤드의 이동거리는 조금 길어지지만 균일한 탐색시간을 제공할 수 있다.



### 5. LOOK과 C-LOOK 알고리즘

- 헤드가 한쪽 방향으로 이동하다가 그 방향에 더 이상 대기 중인 요청이 없으면 즉시 헤드의 이동방향을 반대로 바꾸는 스케줄링 방식
- C-LOOK 알고리즘을 LOOK 알고리즘에서 한쪽 방향으로만 요청처리를 진행한다.

- 지금까지중에는 LOOK, C-LOOK이 가장 효율적이라고 알려져 있다.



## 3. 다중 디스크 환경에서의 스케줄링

- 포털사이트와 같이 수많은 동시 사용자를 서비스하는 서버에서 다중 디스크를 사용한다.
- 동일 정보를 여러 디스크에 중복 저장하여 인기 있는 데이터를 여러 디스크에서 나누어서 서비스 가능하고, 일부 디스크에 오류가 발생해도 지속적인 서비스가 가능하며, 정보의 유실을 방지할 수 있다.
- 이 경우, 동일 정보를 저장하고 있는 디스크 중 어떤 디스크에서 요청을 처리할 지에 대한 스케줄링 문제 발생

- 각 디스크 간의 부하균형을 이루도록 스케줄링하는 것이 중요하다.
- 전력소모를 줄이는 것도 중요한 이슈 -> 부하균형 기법보다는 부하편향 기법이 더 효과적이다.



## 4. 디스크의 저전력 관리

디스크의 상태

활성상태

---

1. 활동 상태
   - 현재 헤드가 데이터를 읽거나 쓰고 있는 상태
2. 공회전 상태
   - 디스크가 회전중이지만 데이터를 읽거나 쓰지는 않는상태

---

비활성상태

---

1. 준비 상태
   - 디스크가 회전하지 않고 인터페이스는 비활성화 된 상태
2. 휴먼 상태
   - 디스크가 회전하지 않고 인터페이스도 비활성화 된 상태

---



### 1. 비활성화 기법

> 디스크의 비활성화 시점을 결정하는 기법

- 시간기반 기법
  - 일정 시간 공회전 상태인 경우 장치를 정지시키고, 요청이 왔을 때 활성화한다.
- 예측기반 기법
  - 과거 요청을 관찰하여 다음 공회전 구간의 길이를 예측한 후 비활성화 시점을 결정한다.
- 확률기반 기법
  - 디바이스의 상태변경 시간 간격을 구하기 위해 확률분포를 통해 요청을 모델링
  - 마르코프 체인 등의 통계 모델 이용



### 2. 회전속도 기법

> 디스크 회전속도롤 가변적으로 조절하는 기법

- 워크로드의 특성을 활용한 시도
- 데이터 접근에 대한 주기성과 규칙성을 활용한 예측을 통해 조절
- 실시간 응용프로그램의 재생률과 버퍼의 크기에 따라 조절



### 3. 데이터 배치 기법

- FS2 파일 시스템 
  - 대부분의 컴퓨터 시스템에서 디스크의 절반 이상이 빈 공간인 상태로 남아 있다는 점에 착안해, 디스크 내에 데이터의 복제본을 많이 만들어 놓는 기법
  - 헤드 위치에서 가까운 복제본에 접근하도록 함으로써 빠른 응답시간과 전력 소모량 절감을 얻을 수있다.



### 4. 버퍼캐싱 및 사전인출 기법

- 미래에 요청될 데이터를 예측해 디스크가 활성 상태일 때 헤드 위치에서 가까운 데이터를 사전인출하는 기법
- 비활성화 가능성을 높여 전력 소모를 줄일 수 있다.



### 5. 쓰기전략을 통한 저전력 디스크 기법

- 디스크 비활성 상태일 때는 쓰지 않다가 활성상태일 때만 쓰는 방식